<template>  <div style="width: 100%;height: 100%">    <CusTabWrap>      <template v-slot:tabBar>        <CusTabBar style="height: 40px">          <CusTabItem v-for="item in tabItems">            {{item.title}}          </CusTabItem>        </CusTabBar>      </template>      <template v-slot:tabContainer>        <CusTabContainer>          <CusTabContainerItem v-for="(item,index) in tabItems">            <ul v-if="item.type==='list'" class="news-list">              <li v-for="data in item.data">                <div class="wrap">                  <div class="left">                    <h5 class="title">                      {{data.title}}                    </h5>                  </div>                  <div class="right">                    <div class="img-box">                      <img :src="data.img" alt="">                    </div>                  </div>                </div>              </li>            </ul>            <ul v-if="item.type==='video'" class="news-video-list">              <li v-for="data in item.data">                <div class="wrap">                  <div class="video">                    <img :src="data.video" alt="">                  </div>                  <h5 class="title">                    {{data.title}}                  </h5>                </div>              </li>            </ul>            <div class="load-more" v-if="tabIndex===index">              正在加载……            </div>          </CusTabContainerItem>        </CusTabContainer>      </template>    </CusTabWrap>  </div></template><script lang="ts">  import { Component, Vue } from 'vue-property-decorator';  import { TabController } from '@/components/vue-cus-tabs';  import { Category } from '@/utils/types';  import { fetchCategory, fetchData } from '@/utils/api';  @Component({    components: {},  })  export default class Dynamic extends Vue {    get tabIndex() {      return this.tabController ? this.tabController.currentIndex : 0;    }    public tabItems: Category[] = [];    public tabController?: TabController<Category>;    private loading = false;    public mounted() {      fetchCategory().then((data) => {        data.forEach((o) => {          o.data = [];        });        this.tabItems = data;        this.tabController = new TabController({          data: this.tabItems,          tabScroll: true,          duration: 500,          scrollEndOffset: 50,          onScrollEnd: (i) => {            if (this.loading) {              return;            }            this.loading = true;            fetchData(this.tabItems[i].type).then((d) => {              this.tabItems[i].data!.push(...d);              this.loading = false;            });          },          onChange: (i) => {            const category = this.tabItems[i];            if (category.data && category.data.length) {              return;            }            fetchData(category.type).then((items) => {              const news = category.data;              if (news && news!.length) {                news!.push(...items);              } else {                category.data = items;              }            });          },        });        fetchData('list').then((o) => {          this.tabItems[0].data!.push(...o);        });      });      setTimeout(() => {        this.tabController!.push({          title: '汽车', type: 'list', data: [],        });        this.tabController!.push({          title: '汽车111111111111', type: 'list', data: [],        });        this.tabController!.push({          title: '汽车222222222222', type: 'list', data: [],        });        this.tabController!.push({          title: '汽车333333333333', type: 'list', data: [],        });        setTimeout(() => {          this.tabController!.remove(0);          setTimeout(() => {            this.tabController!.changeTab(1);            setTimeout(() => {              this.tabController!.remove(1);            }, 2000);          }, 2000);        }, 2000);      }, 2000);    }    public data() {      return {        tabController: null,        tabItems: [],      };    }  }</script><style lang="less" scoped>  @import "style";</style>